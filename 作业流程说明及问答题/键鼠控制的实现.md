###### 用智能指针初始化键鼠

```c++
// 键鼠输入
std::unique_ptr<DirectX::Mouse> m_pMouse;					// 鼠标
DirectX::Mouse::ButtonStateTracker m_MouseTracker;			// 鼠标状态追踪器
std::unique_ptr<DirectX::Keyboard> m_pKeyboard;				// 键盘
DirectX::Keyboard::KeyboardStateTracker m_KeyboardTracker;	// 键盘状态追踪器
```

##### 在GameAPP::Init函数中初始化鼠标

###### 声明智能指针

    m_pMouse = std::make_unique<DirectX::Mouse>();
    m_pKeyboard = std::make_unique<DirectX::Keyboard>();

###### 绑定窗口句柄和设置鼠标模式

```c++
//将鼠标初始化
m_pMouse->SetWindow(m_hMainWnd);
m_pMouse->SetMode(DirectX::Mouse::MODE_ABSOLUTE);
```

##### 在GameApp::UpdateScene 函数中获取键鼠状态

```c++
Mouse::State mouseState = m_pMouse->GetState(); //用GetState()函数获取当前帧鼠标运动状态
Mouse::State lastMouseState = m_MouseTracker.GetLastState(); //获取前一帧鼠标状态
m_MouseTracker.Update(mouseState);//获取完鼠标状态，更新鼠标状态

Keyboard::State keyState = m_pKeyboard->GetState(); //获取当前帧下键盘所有按键的状态
Keyboard::State lastKeyState = m_KeyboardTracker.GetLastState(); //判断按键是刚按下还是刚放开
m_KeyboardTracker.Update(keyState);//获取完键盘状态，更新键盘状态
```

###### 记录获取的状态量差值

```c++
    int dx = mouseState.x - lastMouseState.x, dy = mouseState.y - lastMouseState.y;//用dx和dy记录鼠标的x轴/y轴偏移量
    int dscrollWheel = mouseState.scrollWheelValue - lastMouseState.scrollWheelValue;//用dmin来记录滚轮变化值
```

###### 旋转控制

```
//左键按下且按住时
    if (mouseState.leftButton == true && m_MouseTracker.leftButton == m_MouseTracker.HELD)
    {
        // 旋转立方体
        pyramidTheta -= (dx) * 0.01f;
        pyramidPhi -= (dy) * 0.01f;
    }
    //根据按下的按键进行旋转
if (keyState.IsKeyDown(Keyboard::W)|| keyState.IsKeyDown(Keyboard::Up))  //WS键或上下键控制y轴
    pyramidPhi += dt * 2;
if (keyState.IsKeyDown(Keyboard::S)|| keyState.IsKeyDown(Keyboard::Up))
    pyramidPhi -= dt * 2;
if (keyState.IsKeyDown(Keyboard::A)|| keyState.IsKeyDown(Keyboard::Up))  //AD键或左右键控制x轴
    pyramidTheta += dt * 2;
if (keyState.IsKeyDown(Keyboard::D)|| keyState.IsKeyDown(Keyboard::Up))
    pyramidTheta -= dt * 2;
```

###### 缩放控制

```
    pyramidmid += dscrollWheel * 0.001f;  //根据滚轮变化值来决定缩放
    if (keyState.IsKeyDown(Keyboard::Q))  //QE键控制缩放
        pyramidTheta += dt * 2;
    if (keyState.IsKeyDown(Keyboard::E))
        pyramidTheta -= dt * 2;
```

